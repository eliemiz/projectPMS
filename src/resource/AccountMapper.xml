<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pms.a03_dao.A00_AccountDao">
	<!-- public ArrayList<Account> getAccountList(); -->
	<select id="getAccountList" resultType="account">
	select * from account
	</select>
	
	<!-- public Account Login(String user_id, String password); -->
	<select id="Login" resultType="account">
	SELECT * 
	FROM account
	WHERE user_id=#{user_id} AND password=#{password}
	</select>
	
	<!-- public ArrayList<AccountTask> getAccountTaskList(); -->
	<select id="getAccountTaskList" resultType="accountTask">
		SELECT A.ID ACCOUNT_ID, A.NAME, A.AUTH,
			COUNT(CASE WHEN A.ID = T.ACCOUNT_ID THEN 1 END) TOTAL,
			COUNT(CASE WHEN T.STATUS = '완료' AND A.ID = T.ACCOUNT_ID THEN 1 END) COMPLETED, 
			COUNT(CASE WHEN T.STATUS != '완료' AND A.ID = T.ACCOUNT_ID THEN 1 END) INCOMPLETED
			FROM ACCOUNT A, TASK T GROUP BY (A.ID, A.NAME, A.AUTH) ORDER BY A.ID DESC
	</select>
</mapper>